- Link: https://github.com/ytisf/theZoo/tree/master/malware/Binaries/Ransomware.Jigsaw

## Introduction:
This malware sample was taken from theZoo on Github randomly to perform a quick malware analysis. The link is provided at the top. Handle with caution.

## File Information:
### Hashes:
- MD5 Hash: 2773e3dc59472296cb0024ba7715a64e
- SHA1 Hash: 27d99fbca067f478bb91cdbcb92f13a828b00859
- SHA256 Hash: 3ae96f73d805e1d3995253db4d910300d8442ea603737a1428b613061e7f61e7

### VirusTotal:
- Shows 62 detections
- Identifies it as a `BitcoinBlackmailer.exe` and `Jigsaw Ransomware`

## Static Analysis:
### Strings:
- Found some interesting strings:
```
BitcoinBlackmailer.exe
NothingHappens
DeleteItself
DeleteFiles
GetBitcoinAddess
Blockr
Main.Tools
get_BlockrAddress
GetPrice
GetBalanceBtc
address
WebClient
costura.newtonsoft.json.dll.zip
http://btc.blockr.io/api/v1/
coin/info/
address/balance/
\DeleteItself.bat
TxtTest.txt
I am a txt test.
NotTxtTest.nottxt
I am NOT a txt test.
C:\Windows
EncryptedFileList.txt
SOFTWARE\Microsoft\Windows\CurrentVersion\Run
.zip
OoIsAwwF23cICQoLDA0ODe==
```
- Strings that imply this is a ransomware
```
EncryptedFiles
Address.txt
You are about to make a very bad decision. Are you sure about it?
Great job, I'm decrypting your files...
Decrypting your files. It will take for a while. After done I will close and completely remove myself from your computer.
Great job
You did not sent me enough! Try again!
You haven't made payment yet! Try again!
Are you connected to the internet? Try again!
 files will be deleted
Lucida Console
labelWelcome
I want to play a game
labelTask
All you have to do...
textBoxAddress
12Xspzstah37626slkwKhsKSHA
buttonCheckPayment
I made a payment, now give me back my files!
buttonViewEncryptedFiles
View encrypted files


Congratulations. Your software has been registered. Confirmation code 994759
Email us this code in the chat to active your software. It can take up to 48 hours.
Thank you


Drpbx\drpbx.exe
Frfx\firefox.exe
System32Work\


Your computer files have been encrypted. Your photos, videos, documents, etc....
But, don't worry! I have not deleted them, yet.
You have 24 hours to pay 150 USD in Bitcoins to get the decryption key.
Every hour files will be deleted. Increasing in amount every time.
After 72 hours all that are left will be deleted.
If you do not have bitcoins Google the website localbitcoins.
Purchase 150 American Dollars worth of Bitcoins or .4 BTC. The system will accept either one.
Send to the Bitcoins address specified.
Within two minutes of receiving your payment your computer will receive the decryption key and return to normal.
Try anything funny and the computer has several safety measures to delete your files.
As soon as the payment is received the crypted files will be returned to normal.
       Thank you        
Please, send $
 worth of Bitcoin here:
```
- Opening it in `PEStudio` shows some interesting information
- Description says its `Firefox`
- Also Says its a `.NET` application
- Some of the blacklisted funtions are:
```
WinExec
EncryptFile
DecryptFile
```

### Decompilation:
- Decompiled the binary in `dnSpy`
- Found some interesting functions `Main`, `Main.Properties`, `Main.Tools`
- Found that it may be containing some anti analysis functionalities using `ConfuserEx`
- A look in the `Main` function shows the config set
- The name is set to Firefox
- The encryption will happen with `.fun` extention
- It also shows the 2 persistence methods used, Start Up folder and Registry
- Also found the `EncryptionPassword = "OoIsAwwF23cICQoLDA0ODe=="`
- Found that the encryption used is AES
- Converting the password to binary gives 192 characters
- It means its using 192-bit encryption

## Initial Detonation:
- Shows the confirmation code message box
- Encrypts files with `.fun` extention
- Shows a message box saying files are encrypted send bitcoin on the address
- Using task manager to close it gives a message saying `You are about to make a very bad decision. Are you sure about it?`

## Dynamic Analysis:
### Host Based Indicators:
- Found that it creates 2 new files
```
C:\Users\crypt0ace\AppData\Local\Drpbx\drpbx.exe
C:\Users\crypt0ace\AppData\Roaming\Frfx\firefox.exe
```
- These are possible copies of itself to create presistence

### Network Based Indicators:
- After running the ransomware if we click on `I made a payment, now give me back my files!` we can see network activity happening in wireshark
```
btc.blockr.io/api/v1/coin/info/
```